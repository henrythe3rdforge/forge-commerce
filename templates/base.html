<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Forge Commerce{% endblock %}</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="/static/js/htmx.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="container nav-container">
            <a href="/" class="nav-brand">üî® Forge</a>
            <div class="nav-search">
                <input type="search" name="q" placeholder="Search products..."
                    hx-get="/products/search"
                    hx-trigger="keyup changed delay:300ms"
                    hx-target="#search-results"
                    hx-indicator=".htmx-indicator"
                    autocomplete="off">
                <span class="htmx-indicator">‚è≥</span>
            </div>
            <div class="nav-links">
                <a href="/products">Shop</a>
                {% if user %}
                    <a href="/profile">{{ user.name }}</a>
                    {% if user.is_admin %}<a href="/admin">Admin</a>{% endif %}
                    <a href="/logout">Logout</a>
                {% else %}
                    <a href="/login">Login</a>
                    <a href="/register">Register</a>
                {% endif %}
                <a href="/cart" class="cart-link">
                    üõí <span id="cart-count" hx-get="/api/cart/count" hx-trigger="every 30s">{{ cart_count }}</span>
                </a>
                <label class="theme-toggle" title="Toggle dark mode">
                    <input type="checkbox" id="theme-switch">
                    <span class="theme-icon">üåô</span>
                </label>
            </div>
            <button class="nav-toggle" aria-label="Menu">‚ò∞</button>
        </div>
    </nav>

    <div id="toast" class="toast"></div>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="container footer-grid">
            <div class="footer-col">
                <h4>üî® Forge Commerce</h4>
                <p>Handpicked goods, crafted with care. No fluff, no filler.</p>
            </div>
            <div class="footer-col">
                <h4>Shop</h4>
                <a href="/products">All Products</a>
                <a href="/products?category=Home+%26+Kitchen">Home & Kitchen</a>
                <a href="/products?category=Apparel">Apparel</a>
                <a href="/products?category=Lighting">Lighting</a>
                <a href="/products?category=Stationery">Stationery</a>
            </div>
            <div class="footer-col">
                <h4>Account</h4>
                <a href="/login">Login</a>
                <a href="/register">Register</a>
                <a href="/profile">Profile</a>
                <a href="/cart">Cart</a>
            </div>
            <div class="footer-col">
                <h4>Info</h4>
                <p>Built with Rust, HTMX, and zero JavaScript frameworks.</p>
                <p>¬© 2025 Forge Commerce</p>
            </div>
        </div>
    </footer>

    <noscript>
        <style>.theme-toggle { display: none; }</style>
    </noscript>
</body>
</html>

{% extends "base.html" %}
{% block title %}Cart — Forge Commerce{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Your Cart</h1>
</div>

<div id="cart-content" class="cart-layout">
    <div id="cart-items">
        {% if items | length == 0 %}
        <div class="empty-cart">
            <p>Your cart is empty.</p>
            <a href="/products" class="btn btn-primary">Browse Products</a>
        </div>
        {% else %}
            {% for item in items %}
            <div class="cart-item">
                <img src="{{ item.image_url }}" alt="{{ item.product_name }}" class="cart-item-image">
                <div class="cart-item-details">
                    <h3>{{ item.product_name }}</h3>
                    <p class="cart-item-price">${{ item.price | round(precision=2) }}</p>
                </div>
                <div class="cart-item-quantity">
                    <button class="btn btn-sm"
                        hx-put="/api/cart/{{ item.product_id }}"
                        hx-vals='{"quantity":{{ item.quantity - 1 }}}'
                        hx-target="#cart-content"
                        hx-swap="innerHTML">−</button>
                    <span>{{ item.quantity }}</span>
                    <button class="btn btn-sm"
                        hx-put="/api/cart/{{ item.product_id }}"
                        hx-vals='{"quantity":{{ item.quantity + 1 }}}'
                        hx-target="#cart-content"
                        hx-swap="innerHTML">+</button>
                </div>
                <div class="cart-item-total">${{ (item.price * item.quantity) | round(precision=2) }}</div>
                <button class="btn btn-danger btn-sm"
                    hx-delete="/api/cart/{{ item.product_id }}"
                    hx-target="#cart-content"
                    hx-swap="innerHTML">✕</button>
            </div>
            {% endfor %}
        {% endif %}
    </div>

    <div id="cart-summary">
        <div class="cart-total">
            <span>Total:</span>
            <span>${{ total | round(precision=2) }}</span>
        </div>
        {% if items | length > 0 %}
        <a href="/checkout" class="btn btn-primary btn-block">Proceed to Checkout</a>
        {% endif %}
    </div>
</div>
{% endblock %}
